<!-- å•†å“åˆ†ç±»åˆ—è¡¨é¡µé¢ -->
<view class="category-container">
  <!-- é¡¶éƒ¨æœç´¢æ å’Œç”¨æˆ·ä¿¡æ¯ -->
  <view class="header">
    <view class="search-bar">
      <input class="search-input" placeholder="æœç´¢å•†å“" bindinput="onSearchInput" />
      <view class="search-icon">ğŸ”</view>
    </view>
    <view class="user-info">
      <text class="username">ç”¨æˆ·æ˜µç§°</text>
      <text class="page-title">åˆ†ç±»å•†å“</text>
      <text class="website-tag">å°ç¨‹åº</text>
    </view>
  </view>

  <!-- ä¸»ä½“å†…å®¹åŒº -->
  <view class="main-content">
    <!-- å·¦ä¾§åˆ†ç±»å¯¼èˆª -->
    <scroll-view class="category-nav" scroll-y="true">
      <view 
        class="category-item {{currentCategory === index ? 'active' : ''}}"
        wx:for="{{categories}}" 
        wx:key="index"
        data-index="{{index}}"
        bindtap="switchCategory"
      >
        {{item.name}}
      </view>
    </scroll-view>

    <!-- å³ä¾§å•†å“åˆ—è¡¨ -->
    <scroll-view class="product-list" scroll-y="true">
      <view class="product-grid">
        <view 
          class="product-card"
          wx:for="{{products}}" 
          wx:key="id"
          data-product="{{item}}"
          bindtap="showProductDetail"
        >
          <image class="product-image" src="{{}}" mode="aspectFill" />
          <view class="product-info">
            <text class="product-title">{{item.title}}</text>
            <view class="price-section">
              <text class="price">Â¥{{item.price}}</text>
              <text class="contribution">èµ é€ {{item.contribution}} è´¡çŒ®å€¼</text>
            </view>
          </view>
          <view class="cart-btn" catchtap="addToCart" data-product="{{item}}">
            ğŸ›’
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- åº•éƒ¨TabBar -->
  <view class="tabbar">
    <view class="tab-item">
      <text class="tab-icon">ğŸ </text>
      <text class="tab-text">é¦–é¡µ</text>
    </view>
    <view class="tab-item active">
      <text class="tab-icon">ğŸ“‚</text>
      <text class="tab-text">åˆ†ç±»</text>
    </view>
    <view class="tab-item">
      <text class="tab-icon">ğŸ“¤</text>
      <text class="tab-text">åˆ†äº«</text>
    </view>
    <view class="tab-item">
      <text class="tab-icon">ğŸ›’</text>
      <text class="tab-text">è´­ç‰©è½¦</text>
    </view>
    <view class="tab-item">
      <text class="tab-icon">ğŸ‘¤</text>
      <text class="tab-text">æˆ‘çš„</text>
    </view>
  </view>

  <!-- å•†å“è§„æ ¼å¼¹çª— -->
  <view class="modal-overlay {{showModal ? 'show' : ''}}" bindtap="hideModal">
    <view class="modal-content" catchtap="stopPropagation">
      <!-- å•†å“åŸºç¡€ä¿¡æ¯ -->
      <view class="product-basic-info">
        <image class="product-thumb" src="{{selectedProduct.image}}" mode="aspectFill" />
        <view class="product-details">
          <text class="modal-price">Â¥{{selectedProduct.price}}</text>
          <text class="stock-info">åº“å­˜ï¼š{{selectedProduct.stock}}</text>
          <text class="selected-spec">å·²é€‰è§„æ ¼ï¼š{{selectedSpec}}</text>
        </view>
      </view>

      <!-- è§„æ ¼é€‰æ‹©åŒº -->
      <view class="spec-section">
        <text class="spec-title">{{selectedProduct.title}}</text>
        <scroll-view class="spec-scroll" scroll-x="true">
          <view class="spec-tags">
            <view 
              class="spec-tag {{selectedSpecIndex === index ? 'active' : ''}}"
              wx:for="{{selectedProduct.specs}}" 
              wx:key="index"
              data-index="{{index}}"
              bindtap="selectSpec"
            >
              {{item.name}}
            </view>
          </view>
        </scroll-view>
      </view>

      <!-- æ•°é‡é€‰æ‹©åŒº -->
      <view class="quantity-section">
        <text class="quantity-label">è´­ä¹°æ•°é‡ï¼š</text>
        <view class="quantity-controls">
          <view 
            class="quantity-btn {{quantity <= 1 ? 'disabled' : ''}}"
            bindtap="decreaseQuantity"
          >
            -
          </view>
          <text class="quantity-text">{{quantity}}</text>
          <view 
            class="quantity-btn {{quantity >= selectedProduct.stock ? 'disabled' : ''}}"
            bindtap="increaseQuantity"
          >
            +
          </view>
        </view>
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <view class="action-buttons">
        <button class="btn-cart" bindtap="addToCartFromModal">åŠ å…¥è´­ç‰©è½¦</button>
        <button class="btn-buy" bindtap="buyNow">ç«‹å³è´­ä¹°</button>
      </view>
    </view>
  </view>
</view> 